<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml"> <head> <meta charset="utf-8"> <title>Lisp-Chat</title> <meta name="viewport" content="width=device-width"> <meta name="description" content="An experimental chat irc-like"> <meta name="author" content="Manoel Vilela"> <style type="text/css"> body{
          max-width: 1024px;
          margin: 0 auto 0 auto;
          font-family: sans-serif;
          color: #333333;
          font-size: 14pt;
          padding: 5px;
      }
      body>header{
          display:flex;
          align-items: center;
          justify-content: center;
          flex-direction: column;
          max-width: 100%;
          text-align: center;
      }
      body>header img{
          max-width: 50%;
      }
      img{
          max-width: 100%;
          max-height: 100%;
      }
      code{
          font-family: Consolas, Inconsolata, monospace;
      }
      a{
          text-decoration: none;
          color: #0055AA;
      }
      a img{
          border: none;
      }
      #documentation{
          text-align: justify;
      }
      #documentation pre{
          margin-left: 20px;
          overflow: auto;
      }
      #documentation img{
          margin: 5px;
      }
      #symbol-index>ul{
          list-style: none;
          padding: 0;
      }
      #symbol-index .package>ul{
          list-style: none;
          padding: 0 0 0 10px;
      }
      #symbol-index .package .nicknames{
          font-weight: normal;
      }
      #symbol-index .package h4{
          display: inline-block;
          margin: 0;
      }
      #symbol-index .package article{
          margin: 0 0 15px 0;
      }
      #symbol-index .package article header{
          font-size: 1.2em;
          font-weight: normal;
      }
      #symbol-index .package .name{
          margin-right: 5px;
      }
      #symbol-index .package .docstring{
          margin: 0 0 0 15px;
          white-space: pre-wrap;
          font-size: 12pt;
      }
      @media (max-width: 800px){
          body{font-size: 12pt;}
      } </style> </head> <body> <header> <h1><img alt="lisp-chat" src="lisp-chat.png"></h1> <span class="version">0.1</span> <p class="description">An experimental chat irc-like</p> </header> <main> <article id="documentation">  <div><p align="center"><img src="logo/horizontal.png" alt="lisp-chat" height="150px"></p> <p><a href="http://quickdocs.org/lisp-chat/"><img src="http://quickdocs.org/badge/lisp-chat.svg" alt="Quicklisp dist"></a> </p> <h1>Lisp Chat</h1> <p>An experimental chat irc-like written in Lisp.</p> <p><img src="lisp-chat.png" alt="lisp-chat-screenshot"></p> <h1>Installation</h1> <p>You'll need in your system:</p> <ul> <li><a href="http://www.sbcl.org/">SBCL</a></li> <li><a href="https://github.com/quicklisp/quicklisp-client">Quicklisp Client</a></li> </ul> <p>Make sure that <code>~/.sbclrc</code> has a entry calling to the Quicklisp setup.</p> <pre><code><span class="code"><span class="paren1">(<span class="code">load <span class="string">&quot;~/.quicklisp/setup.lisp&quot;</span></span>)</span></span></code></pre> <p>Since that <code>~/.quicklisp</code> is the Quicklisp instalation distribution, clone this
repository with:</p> <p><code>git clone https://www.github.com/ryukinix/lisp-chat.git ~/.quicklisp/local-projects/lisp-chat</code></p> <h2>Tip for Quicklisp</h2> <p>As I said, we'll need a proper instalation of Quicklisp to getting this running. To accomplish that,
if you are not familiar with the CL ecossystem, I'll guide you in a simple way: clone the <a href="https://github.com/quicklisp/quicklisp-client">Quicklisp Client</a> and execute the <code>setup.lisp</code> with <code>sbcl --script setup.lisp</code>.</p> <p>In general Quicklisp distribution provide the folder <code>~/quicklisp</code> instead
of <code>~/.quicklisp</code>, but I personally don't like it much. Make sure to synchronize with the quicklisp correct folder. Maybe
will need change the <code>.sblcrc</code> file to accomplish that, since for default as I said quicklisp set <code>~/quicklisp</code> folder.</p> <h1>Usage</h1> <p>Load the server <code>bash
$ ./lisp-chat-server </code></p> <p>Get a client <code>bash
$ ./lisp-chat </code></p> <p>You can easilly setup your own configuration of <code><a href="#LISP-CHAT-CONFIG:*PORT*">*port*</a></code> and <code>*domain*</code> for running a new instance of the server and client. For
now we have a instance of lisp-chat as example running. If you really
want to runs locally, you can just change the <code>*domain*</code> variable to <code>&quot;localhost&quot;</code> as:</p> <pre><code><span class="code"><span class="paren1">(<span class="code">require 'lisp-chat</span>)</span>
<span class="paren1">(<span class="code"><i><span class="symbol">setq</span></i> <span class="special">lisp-chat-config:*domain*</span> <span class="string">&quot;localhost&quot;</span></span>)</span></span></code></pre> <h1>For Non-lispers</h1> <p>If you want test this and don't have the Lisp environment with SBCL
and Quicklisp, I have two alternative choices for you:</p> <ul> <li>Python client</li> <li>Netcat client (wtf?)</li> </ul> <p>On Python client, I wrote in a way only using ths stdlib avoiding pain to handle the dependency hell, so you can just call that:</p> <pre><code>$ python client.py</code></pre> <p>So finally... netcat. Yes! You can even just use <code>netcat</code>! An user called <code>Chris</code> in past days
just logged in the server with the following message:</p> <pre><code>|16:30:37| [Chris]: Used netcad
|16:30:41| [Chris]: netcat*
|16:30:50| [Chris]: bye</code></pre> <p>So you can type <code>netcat chat.lerax.me 5558</code> and go on! I tested on my machine and
works fine! The main reason is because the communication between
server and client just use raw data. For better synchronization with
text data from server while you typing, I suggest you to
use a readline wrapper like <a href="https://github.com/hanslub42/rlwrap"><code>rlwrap</code></a> calling as <code>rlwrap netcat
ryukinix.tk 5558</code>. <p align="center"> <a href="http://chat.lerax.me"> <img src="http://www.lisperati.com/lisplogo_warning2_256.png" width="128"> </a> </p></p> </div>  </article> <article id="copyright">  <h2>Copyright</h2> <span>lisp-chat</span> is licensed under the <span><a href="https://tldrlegal.com/search?q=MIT">MIT</a></span> license.  Â© <span>Manoel Vilela</span> .    </article>  <article id="symbol-index"> <h2>Package Index</h2> <ul><li class="package"> <h3> <a name="LISP-CHAT-CONFIG" href="#LISP-CHAT-CONFIG">LISP-CHAT-CONFIG</a> <span class="nicknames"></span> </h3> <ul><li> <a name="LISP-CHAT-CONFIG:*DEBUG*"> </a> <article id="SPECIAL LISP-CHAT-CONFIG:*DEBUG*"> <header class="special"> <span class="type">special</span>  <h4 class="name"><code><a href="#SPECIAL%20LISP-CHAT-CONFIG%3A%2ADEBUG%2A">*DEBUG*</a></code></h4>  </header> <div class="docstring"><pre>Run application in debug mode with extra info in terminal</pre></div> </article> </li><li> <a name="LISP-CHAT-CONFIG:*HOST*"> </a> <article id="SPECIAL LISP-CHAT-CONFIG:*HOST*"> <header class="special"> <span class="type">special</span>  <h4 class="name"><code><a href="#SPECIAL%20LISP-CHAT-CONFIG%3A%2AHOST%2A">*HOST*</a></code></h4>  </header> <div class="docstring"><pre>Host used in server and client</pre></div> </article> </li><li> <a name="LISP-CHAT-CONFIG:*PORT*"> </a> <article id="SPECIAL LISP-CHAT-CONFIG:*PORT*"> <header class="special"> <span class="type">special</span>  <h4 class="name"><code><a href="#SPECIAL%20LISP-CHAT-CONFIG%3A%2APORT%2A">*PORT*</a></code></h4>  </header> <div class="docstring"><pre>Default port</pre></div> </article> </li></ul> </li><li class="package"> <h3> <a name="LISP-CHAT-CLIENT" href="#LISP-CHAT-CLIENT">LISP-CHAT-CLIENT</a> <span class="nicknames"></span> </h3> <ul><li> <a name="LISP-CHAT-CLIENT:*IO-MUTEX*"> </a> <article id="SPECIAL LISP-CHAT-CLIENT:*IO-MUTEX*"> <header class="special"> <span class="type">special</span>  <h4 class="name"><code><a href="#SPECIAL%20LISP-CHAT-CLIENT%3A%2AIO-MUTEX%2A">*IO-MUTEX*</a></code></h4>  </header> <div class="docstring"><pre>I/O Mutex for avoid terminal race conditions</pre></div> </article> </li><li> <a name="LISP-CHAT-CLIENT:CLIENT-LOOP"> </a> <article id="FUNCTION LISP-CHAT-CLIENT:CLIENT-LOOP"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-CLIENT%3ACLIENT-LOOP">CLIENT-LOOP</a></code></h4> <code class="qualifiers"></code> <code class="arguments"></code><code>)</code>  </header> <div class="docstring"><pre>Dispatch client threads for basic functioning system</pre></div> </article> </li><li> <a name="LISP-CHAT-CLIENT:CLIENT-SENDER"> </a> <article id="FUNCTION LISP-CHAT-CLIENT:CLIENT-SENDER"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-CLIENT%3ACLIENT-SENDER">CLIENT-SENDER</a></code></h4> <code class="qualifiers"></code> <code class="arguments">SOCKET USERNAME</code><code>)</code>  </header> <div class="docstring"><pre>Routine to check new messages being typed by the user</pre></div> </article> </li><li> <a name="LISP-CHAT-CLIENT:GET-USER-INPUT"> </a> <article id="FUNCTION LISP-CHAT-CLIENT:GET-USER-INPUT"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-CLIENT%3AGET-USER-INPUT">GET-USER-INPUT</a></code></h4> <code class="qualifiers"></code> <code class="arguments">USERNAME</code><code>)</code>  </header> <div class="docstring"><pre>Get the user input by using readline</pre></div> </article> </li><li> <a name="LISP-CHAT-CLIENT:MAIN"> </a> <article id="FUNCTION LISP-CHAT-CLIENT:MAIN"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-CLIENT%3AMAIN">MAIN</a></code></h4> <code class="qualifiers"></code> <code class="arguments"></code><code>)</code>  </header> <div class="docstring"><pre>Main function of client</pre></div> </article> </li><li> <a name="LISP-CHAT-CLIENT:RECEIVE-MESSAGE"> </a> <article id="FUNCTION LISP-CHAT-CLIENT:RECEIVE-MESSAGE"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-CLIENT%3ARECEIVE-MESSAGE">RECEIVE-MESSAGE</a></code></h4> <code class="qualifiers"></code> <code class="arguments">MESSAGE</code><code>)</code>  </header> <div class="docstring"><pre>Receive a message and print in the terminal carefully with IO race conditions</pre></div> </article> </li><li> <a name="LISP-CHAT-CLIENT:SEND-MESSAGE"> </a> <article id="FUNCTION LISP-CHAT-CLIENT:SEND-MESSAGE"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-CLIENT%3ASEND-MESSAGE">SEND-MESSAGE</a></code></h4> <code class="qualifiers"></code> <code class="arguments">MESSAGE SOCKET</code><code>)</code>  </header> <div class="docstring"><pre>Send a MESSAGE string through a SOCKET instance</pre></div> </article> </li><li> <a name="LISP-CHAT-CLIENT:SERVER-BROADCAST"> </a> <article id="FUNCTION LISP-CHAT-CLIENT:SERVER-BROADCAST"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-CLIENT%3ASERVER-BROADCAST">SERVER-BROADCAST</a></code></h4> <code class="qualifiers"></code> <code class="arguments">SOCKET</code><code>)</code>  </header> <div class="docstring"><pre>Call server-listener treating exceptional cases</pre></div> </article> </li><li> <a name="LISP-CHAT-CLIENT:SERVER-LISTENER"> </a> <article id="FUNCTION LISP-CHAT-CLIENT:SERVER-LISTENER"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-CLIENT%3ASERVER-LISTENER">SERVER-LISTENER</a></code></h4> <code class="qualifiers"></code> <code class="arguments">SOCKET</code><code>)</code>  </header> <div class="docstring"><pre>Routine to check new messages coming from the server</pre></div> </article> </li></ul> </li><li class="package"> <h3> <a name="LISP-CHAT-SERVER" href="#LISP-CHAT-SERVER">LISP-CHAT-SERVER</a> <span class="nicknames"></span> </h3> <ul><li> <a name="LISP-CHAT-SERVER:*CLIENT-MUTEX*"> </a> <article id="SPECIAL LISP-CHAT-SERVER:*CLIENT-MUTEX*"> <header class="special"> <span class="type">special</span>  <h4 class="name"><code><a href="#SPECIAL%20LISP-CHAT-SERVER%3A%2ACLIENT-MUTEX%2A">*CLIENT-MUTEX*</a></code></h4>  </header> <div class="docstring"><i>No docstring provided.</i></div> </article> </li><li> <a name="LISP-CHAT-SERVER:*CLIENTS*"> </a> <article id="SPECIAL LISP-CHAT-SERVER:*CLIENTS*"> <header class="special"> <span class="type">special</span>  <h4 class="name"><code><a href="#SPECIAL%20LISP-CHAT-SERVER%3A%2ACLIENTS%2A">*CLIENTS*</a></code></h4>  </header> <div class="docstring"><pre>List of clients</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:*COMMANDS-NAMES*"> </a> <article id="SPECIAL LISP-CHAT-SERVER:*COMMANDS-NAMES*"> <header class="special"> <span class="type">special</span>  <h4 class="name"><code><a href="#SPECIAL%20LISP-CHAT-SERVER%3A%2ACOMMANDS-NAMES%2A">*COMMANDS-NAMES*</a></code></h4>  </header> <div class="docstring"><pre>Allowed command names to be called by client user</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:*MESSAGE-SEMAPHORE*"> </a> <article id="SPECIAL LISP-CHAT-SERVER:*MESSAGE-SEMAPHORE*"> <header class="special"> <span class="type">special</span>  <h4 class="name"><code><a href="#SPECIAL%20LISP-CHAT-SERVER%3A%2AMESSAGE-SEMAPHORE%2A">*MESSAGE-SEMAPHORE*</a></code></h4>  </header> <div class="docstring"><i>No docstring provided.</i></div> </article> </li><li> <a name="LISP-CHAT-SERVER:*MESSAGES-LOG*"> </a> <article id="SPECIAL LISP-CHAT-SERVER:*MESSAGES-LOG*"> <header class="special"> <span class="type">special</span>  <h4 class="name"><code><a href="#SPECIAL%20LISP-CHAT-SERVER%3A%2AMESSAGES-LOG%2A">*MESSAGES-LOG*</a></code></h4>  </header> <div class="docstring"><pre>Messages log</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:*MESSAGES-STACK*"> </a> <article id="SPECIAL LISP-CHAT-SERVER:*MESSAGES-STACK*"> <header class="special"> <span class="type">special</span>  <h4 class="name"><code><a href="#SPECIAL%20LISP-CHAT-SERVER%3A%2AMESSAGES-STACK%2A">*MESSAGES-STACK*</a></code></h4>  </header> <div class="docstring"><pre>Messages pending to be send by broadcasting</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:*SERVER-NICKNAME*"> </a> <article id="SPECIAL LISP-CHAT-SERVER:*SERVER-NICKNAME*"> <header class="special"> <span class="type">special</span>  <h4 class="name"><code><a href="#SPECIAL%20LISP-CHAT-SERVER%3A%2ASERVER-NICKNAME%2A">*SERVER-NICKNAME*</a></code></h4>  </header> <div class="docstring"><pre>The server nickname</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:*UPTIME*"> </a> <article id="SPECIAL LISP-CHAT-SERVER:*UPTIME*"> <header class="special"> <span class="type">special</span>  <h4 class="name"><code><a href="#SPECIAL%20LISP-CHAT-SERVER%3A%2AUPTIME%2A">*UPTIME*</a></code></h4>  </header> <div class="docstring"><pre>Uptime of server variable</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:CLIENT"> </a> <article id="CLASS LISP-CHAT-SERVER:CLIENT"> <header class="class"> <span class="type">class</span>  <h4 class="name"><code><a href="#CLASS%20LISP-CHAT-SERVER%3ACLIENT">CLIENT</a></code></h4>  </header> <div class="docstring"><pre>This structure handle the creation/control of the clients of the server.
   NAME is a string. Socket is a USOCKET:SOCKET and address is a ipv4 encoded
   string. </pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:MESSAGE"> </a> <article id="CLASS LISP-CHAT-SERVER:MESSAGE"> <header class="class"> <span class="type">class</span>  <h4 class="name"><code><a href="#CLASS%20LISP-CHAT-SERVER%3AMESSAGE">MESSAGE</a></code></h4>  </header> <div class="docstring"><pre>This structure abstract the type message with is saved
   into *messages-log* and until consumed, temporally pushed
   to *messages-stack*. FROM, CONTENT and TIME has type string</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:/HELP"> </a> <article id="FUNCTION LISP-CHAT-SERVER:/HELP"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3A%2FHELP">/HELP</a></code></h4> <code class="qualifiers"></code> <code class="arguments">CLIENT &amp;REST ARGS</code><code>)</code>  </header> <div class="docstring"><pre>Show a list of the available commands of lisp-chat</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:/LOG"> </a> <article id="FUNCTION LISP-CHAT-SERVER:/LOG"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3A%2FLOG">/LOG</a></code></h4> <code class="qualifiers"></code> <code class="arguments">CLIENT &amp;OPTIONAL (DEPTH &quot;20&quot;) &amp;REST ARGS</code><code>)</code>  </header> <div class="docstring"><pre>Show the last messages typed on the server.
   DEPTH is optional number of messages frames from log</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:/NICK"> </a> <article id="FUNCTION LISP-CHAT-SERVER:/NICK"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3A%2FNICK">/NICK</a></code></h4> <code class="qualifiers"></code> <code class="arguments">CLIENT &amp;OPTIONAL (NEW-NICK NIL) &amp;REST ARGS</code><code>)</code>  </header> <div class="docstring"><pre>Change the client-name given a NEW-NICK which should be a string</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:/UPTIME"> </a> <article id="FUNCTION LISP-CHAT-SERVER:/UPTIME"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3A%2FUPTIME">/UPTIME</a></code></h4> <code class="qualifiers"></code> <code class="arguments">CLIENT &amp;REST ARGS</code><code>)</code>  </header> <div class="docstring"><pre>Return a string nice encoded to preset the uptime since the server started.</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:/USERS"> </a> <article id="FUNCTION LISP-CHAT-SERVER:/USERS"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3A%2FUSERS">/USERS</a></code></h4> <code class="qualifiers"></code> <code class="arguments">CLIENT &amp;REST ARGS</code><code>)</code>  </header> <div class="docstring"><pre>Return a list separated by commas of the currently logged users</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:CALL-COMMAND"> </a> <article id="FUNCTION LISP-CHAT-SERVER:CALL-COMMAND"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3ACALL-COMMAND">CALL-COMMAND</a></code></h4> <code class="qualifiers"></code> <code class="arguments">CLIENT MESSAGE</code><code>)</code>  </header> <div class="docstring"><i>No docstring provided.</i></div> </article> </li><li> <a name="LISP-CHAT-SERVER:CALL-COMMAND-BY-NAME"> </a> <article id="FUNCTION LISP-CHAT-SERVER:CALL-COMMAND-BY-NAME"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3ACALL-COMMAND-BY-NAME">CALL-COMMAND-BY-NAME</a></code></h4> <code class="qualifiers"></code> <code class="arguments">STRING PARAMS</code><code>)</code>  </header> <div class="docstring"><pre>Wow, this is a horrible hack to get a string as symbol for functions/command
  like /help /users /log and so on.</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:CLIENT-DELETE"> </a> <article id="FUNCTION LISP-CHAT-SERVER:CLIENT-DELETE"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3ACLIENT-DELETE">CLIENT-DELETE</a></code></h4> <code class="qualifiers"></code> <code class="arguments">CLIENT</code><code>)</code>  </header> <div class="docstring"><pre>Delete a CLIENT from the list *clients*</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:CLIENT-READER"> </a> <article id="FUNCTION LISP-CHAT-SERVER:CLIENT-READER"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3ACLIENT-READER">CLIENT-READER</a></code></h4> <code class="qualifiers"></code> <code class="arguments">CLIENT</code><code>)</code>  </header> <div class="docstring"><pre>This procedure is a wrapper for CLIENT-READER-ROUTINE
   treating all the possible errors based on HANDLER-CASE macro.</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:CLIENT-READER-ROUTINE"> </a> <article id="FUNCTION LISP-CHAT-SERVER:CLIENT-READER-ROUTINE"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3ACLIENT-READER-ROUTINE">CLIENT-READER-ROUTINE</a></code></h4> <code class="qualifiers"></code> <code class="arguments">CLIENT</code><code>)</code>  </header> <div class="docstring"><pre>This function create a IO-bound procedure to act
   by reading the events of a specific CLIENT.
   On this software each client talks on your own thread.</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:CLIENT-STREAM"> </a> <article id="FUNCTION LISP-CHAT-SERVER:CLIENT-STREAM"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3ACLIENT-STREAM">CLIENT-STREAM</a></code></h4> <code class="qualifiers"></code> <code class="arguments">C</code><code>)</code>  </header> <div class="docstring"><pre>Select the stream IO from the client</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:COMMAND-MESSAGE"> </a> <article id="FUNCTION LISP-CHAT-SERVER:COMMAND-MESSAGE"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3ACOMMAND-MESSAGE">COMMAND-MESSAGE</a></code></h4> <code class="qualifiers"></code> <code class="arguments">CONTENT</code><code>)</code>  </header> <div class="docstring"><pre>This function prepare the CONTENT as a message by the @server</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:CONNECTION-HANDLER"> </a> <article id="FUNCTION LISP-CHAT-SERVER:CONNECTION-HANDLER"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3ACONNECTION-HANDLER">CONNECTION-HANDLER</a></code></h4> <code class="qualifiers"></code> <code class="arguments">SOCKET-SERVER</code><code>)</code>  </header> <div class="docstring"><pre>This is a special thread just for accepting connections from SOCKET-SERVER
   and creating new clients from it.</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:CREATE-CLIENT"> </a> <article id="FUNCTION LISP-CHAT-SERVER:CREATE-CLIENT"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3ACREATE-CLIENT">CREATE-CLIENT</a></code></h4> <code class="qualifiers"></code> <code class="arguments">CONNECTION</code><code>)</code>  </header> <div class="docstring"><pre>This procedure create a new client based on CONNECTION made by
  USOCKET:SOCKET-ACCEPT. This shit create a lot of side effects as messages
  if the debug is on because this makes all the log stuff to make analysis</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:DEBUG-FORMAT"> </a> <article id="FUNCTION LISP-CHAT-SERVER:DEBUG-FORMAT"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3ADEBUG-FORMAT">DEBUG-FORMAT</a></code></h4> <code class="qualifiers"></code> <code class="arguments">&amp;REST ARGS</code><code>)</code>  </header> <div class="docstring"><pre>If *debug* from lisp-chat-config is true, print debug info on
   running based on ARGS</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:EXTRACT-PARAMS"> </a> <article id="FUNCTION LISP-CHAT-SERVER:EXTRACT-PARAMS"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3AEXTRACT-PARAMS">EXTRACT-PARAMS</a></code></h4> <code class="qualifiers"></code> <code class="arguments">STRING</code><code>)</code>  </header> <div class="docstring"><i>No docstring provided.</i></div> </article> </li><li> <a name="LISP-CHAT-SERVER:FORMATED-MESSAGE"> </a> <article id="FUNCTION LISP-CHAT-SERVER:FORMATED-MESSAGE"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3AFORMATED-MESSAGE">FORMATED-MESSAGE</a></code></h4> <code class="qualifiers"></code> <code class="arguments">MESSAGE</code><code>)</code>  </header> <div class="docstring"><pre>The default message format of this server. MESSAGE is a string
   Changing this reflects all the layout from client/server.
   Probably this would be the MFRP: Manoel Fucking Raw Protocol.
   Because this we can still use netcat as client for lisp-chat.</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:GET-TIME"> </a> <article id="FUNCTION LISP-CHAT-SERVER:GET-TIME"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3AGET-TIME">GET-TIME</a></code></h4> <code class="qualifiers"></code> <code class="arguments"></code><code>)</code>  </header> <div class="docstring"><pre>Return a encoded string as HH:MM:SS based on the current timestamp.</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:MAIN"> </a> <article id="FUNCTION LISP-CHAT-SERVER:MAIN"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3AMAIN">MAIN</a></code></h4> <code class="qualifiers"></code> <code class="arguments"></code><code>)</code>  </header> <div class="docstring"><pre>Well, this function run all the necessary shits.</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:MESSAGE-BROADCAST"> </a> <article id="FUNCTION LISP-CHAT-SERVER:MESSAGE-BROADCAST"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3AMESSAGE-BROADCAST">MESSAGE-BROADCAST</a></code></h4> <code class="qualifiers"></code> <code class="arguments"></code><code>)</code>  </header> <div class="docstring"><pre>This procedure is a general independent thread to run brodcasting
   all the clients when a message is ping on this server</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:PUSH-MESSAGE"> </a> <article id="FUNCTION LISP-CHAT-SERVER:PUSH-MESSAGE"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3APUSH-MESSAGE">PUSH-MESSAGE</a></code></h4> <code class="qualifiers"></code> <code class="arguments">FROM CONTENT</code><code>)</code>  </header> <div class="docstring"><pre>Push a messaged FROM as CONTENT into the *messages-stack*</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:SAFE-CLIENT-THREAD"> </a> <article id="FUNCTION LISP-CHAT-SERVER:SAFE-CLIENT-THREAD"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3ASAFE-CLIENT-THREAD">SAFE-CLIENT-THREAD</a></code></h4> <code class="qualifiers"></code> <code class="arguments">CONNECTION</code><code>)</code>  </header> <div class="docstring"><pre>This function is a wrapper for CREATE-CLIENT treating the
exceptions.</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:SEND-MESSAGE"> </a> <article id="FUNCTION LISP-CHAT-SERVER:SEND-MESSAGE"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3ASEND-MESSAGE">SEND-MESSAGE</a></code></h4> <code class="qualifiers"></code> <code class="arguments">CLIENT MESSAGE</code><code>)</code>  </header> <div class="docstring"><pre>Send to CLIENT a MESSAGE :type string</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:SERVER-LOOP"> </a> <article id="FUNCTION LISP-CHAT-SERVER:SERVER-LOOP"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3ASERVER-LOOP">SERVER-LOOP</a></code></h4> <code class="qualifiers"></code> <code class="arguments">SOCKET-SERVER</code><code>)</code>  </header> <div class="docstring"><pre>This is the general server-loop procedure. Create the threads
   necessary for the basic working state of this chat. The main idea
   is creating a MESSAGE-BROADCAST procedure and CONNECTION-HANDLER
   procedure running as separated threads.

   The first procedure send always a new message too all clients
   defined on *clients* when *messages-semaphore* is signalized.
   The second procedure is a general connection-handler for new
   clients trying connecting to the server.</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:SOCKET-PEER-ADDRESS"> </a> <article id="FUNCTION LISP-CHAT-SERVER:SOCKET-PEER-ADDRESS"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3ASOCKET-PEER-ADDRESS">SOCKET-PEER-ADDRESS</a></code></h4> <code class="qualifiers"></code> <code class="arguments">SOCKET</code><code>)</code>  </header> <div class="docstring"><pre>Given a USOCKET:SOCKET instance return a ipv4 encoded IP string</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:SPLIT"> </a> <article id="FUNCTION LISP-CHAT-SERVER:SPLIT"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3ASPLIT">SPLIT</a></code></h4> <code class="qualifiers"></code> <code class="arguments">STRING DELIMITERP</code><code>)</code>  </header> <div class="docstring"><pre>Split a string by a delimiterp function character checking</pre></div> </article> </li><li> <a name="LISP-CHAT-SERVER:STARTSWITH"> </a> <article id="FUNCTION LISP-CHAT-SERVER:STARTSWITH"> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#FUNCTION%20LISP-CHAT-SERVER%3ASTARTSWITH">STARTSWITH</a></code></h4> <code class="qualifiers"></code> <code class="arguments">STRING SUBSTRING</code><code>)</code>  </header> <div class="docstring"><pre>Check if STRING starts with SUBSTRING.</pre></div> </article> </li></ul> </li></ul> </article>  </main> </body> </html> 